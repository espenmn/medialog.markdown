<html>
<body tal:define="id string:${view/id}">
<div class="previewbuttons">
  <p class="button-field context fa fa-eye-slash disabled" id="hidepreview"></p>
  <p class="button-field context fa fa-arrows disabled" id="previewv"></p>
  <p class="button-field context fa fa-eye" id="mdpreview"> Update Preview</p>
</div>
<textarea  class="markdown-textarea"
           type="textarea"
           role="markdown"  
           tal:attributes="id id;
           name view/name;
           value view/value;
           disabled view/disabled;
           alt view/alt;
           accesskey view/accesskey;
           onselect view/onselect;"   
           tal:content="view/value"/>

<link rel="stylesheet" href="http://ace.jeka.by/assets/font-awesome/4.5.0/css/font-awesome.min.css" />
<link rel="stylesheet" href="++resource++medialog.markdown/markdown.css" />
<textarea id="result" class="fullwidth"> </textarea>

<script tal:replace="structure view/make_buttons"></script>
<script>
$( "#mdpreview" ).click(function() {
var md = $('#${id}').val();
$.post("render_from_markdown", { markdown: md}, function( data ) {
  $('#result').show();
  $( "#result" ).html( data );
  $('#hidepreview,  #previewv').removeClass('disabled');
});
});
$( "#hidepreview" ).click(function() {
  $('#result').hide();
  $('#result, .md-textarea, #${id}').removeClass( 'halfwidth' );
  $('#result, .md-textarea, #${id}').addClass( 'fullwidth' );
  $('#hidepreview,  #previewv').addClass('disabled');
});
$( "#previewv" ).click(function() {
  $('#result, .md-textarea, #${id}').toggleClass( 'halfwidth' );
  $('#result, .md-textarea, #${id}').toggleClass( 'fullwidth' );
});
</script>
<script tal:condition="view/live_preview">
$(document).on('keypress', '#${id}', function(e) {
        if ( e.keyCode == 13 ) {  // detect the enter key
            $('#mdpreview').click(); // fire a sample click,  you can do anything
        }
});
</script>   
   
</body>
</html>
 
 
